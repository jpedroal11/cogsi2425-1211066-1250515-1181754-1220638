---
- name: Check if H2 database port is open
  wait_for:
    port: 9092
    host: "{{ ansible_default_ipv4.address }}"
    delay: 5
    timeout: 30
    state: started
  register: h2_port_check

- name: Show H2 port check result
  debug:
    msg: "✅ H2 database port 9092 is open and accepting connections"

- name: Check if H2 web console is responding
  uri:
    url: "http://localhost:8082"
    method: GET
    status_code: 200, 401, 302
    timeout: 10
  register: h2_web_check
  ignore_errors: yes

- name: Show H2 web console check result
  debug:
    msg: "✅ H2 web console is accessible"
  when: h2_web_check.status in [200, 401, 302]